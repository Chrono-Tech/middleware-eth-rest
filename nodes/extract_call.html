<script type="text/javascript">
  RED.nodes.registerType("sc-extract-call", {
    category: "smart contracts",
    color: "#E2D96E",
    defaults: {
      contract: {value: ""},
      contractFunction: {value: ""},
      args: [],
      name: {value: 'sc-extract-call'}
    },
    inputs: 1,
    outputs: 1,
    icon: "function.png",
    label: function () {
      return this.name;
    },
    oneditprepare: function () {
      let resizeRule = rule => {
        let newWidth = rule.width();
        rule.find('.red-ui-typedInput').typedInput("width", (newWidth - 15) / 2);
      };

      let argsList = $("#node-input-args-container").editableList({
        addItem: function (container, index, data) {
          let row = $('<div/>').appendTo(container);

          let input = $('<input/>', {class: "node-input-arg-value", type: "text"})
            .appendTo(row);

          if (typeof data === 'string')
            input.val(data);

          resizeRule(container);
        },
        resizeItem: resizeRule,
        removable: true
      });

      if (this.args) {
        for (let arg of this.args) {
          argsList.editableList('addItem', arg);
        }
      }
    },
    oneditsave: function () {
      let args = $("#node-input-args-container").editableList('items');
      let node = this;
      node.args = [];
      args.each(function () {
        let arg = $(this);
        let val = arg.find(".node-input-arg-value").val();
        node.args.push(val);

      });
    }
  });
</script>

<script type="text/x-red" data-template-name="sc-extract-call">

    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>

    <div class="form-row">
        <label for="node-input-contract"><i class="icon-tag"></i> contract name</label>
        <input type="text" id="node-input-contract" placeholder="contract_name">
    </div>

    <div class="form-row">
        <label for="node-input-contractFunction"><i class="icon-tag"></i> contract function</label>
        <input type="text" id="node-input-contractFunction" placeholder="contract function"/>
    </div>


    <div class="form-row" style="margin-bottom:0;">
        <label><i class="fa fa-list"></i> args</label>
    </div>
    <div class="form-row node-input-args-container-row">
        <ol id="node-input-args-container"></ol>
    </div>









</script>

<script type="text/x-red" data-help-name="extract_call">
    <p> transform sc call to unsigned tx </p>







</script>
